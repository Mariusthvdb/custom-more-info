!function(){"use strict";function e(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function l(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,l)}a((o=o.apply(e,t||[])).next())}))}function t(e,t){var n,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(a){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(s=0)),s;)try{if(n=1,o&&(i=2&l[0]?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return s.label++,{value:l[1],done:!1};case 5:s.label++,o=l[1],l=[0];continue;case 7:l=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){s=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){s.label=l[1];break}if(6===l[0]&&s.label<i[1]){s.label=i[1],i=l;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(l);break}i[2]&&s.ops.pop(),s.trys.pop();continue}l=t.call(e,s)}catch(e){l=[6,e],o=0}finally{n=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,a])}}}"function"==typeof SuppressedError&&SuppressedError;var n=function(){return n=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};function o(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{a(o.next(e))}catch(e){r(e)}}function l(e){try{a(o.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,l)}a((o=o.apply(e,t||[])).next())}))}function i(e,t){var n,o,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(a){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(s=0)),s;)try{if(n=1,o&&(i=2&l[0]?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return s.label++,{value:l[1],done:!1};case 5:s.label++,o=l[1],l=[0];continue;case 7:l=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==l[0]&&2!==l[0])){s=0;continue}if(3===l[0]&&(!i||l[1]>i[0]&&l[1]<i[3])){s.label=l[1];break}if(6===l[0]&&s.label<i[1]){s.label=i[1],i=l;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(l);break}i[2]&&s.ops.pop(),s.trys.pop();continue}l=t.call(e,s)}catch(e){l=[6,e],o=0}finally{n=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,a])}}}"function"==typeof SuppressedError&&SuppressedError;var r="$",s=":host",l="invalid selector";function a(e,t,n,o,i){return void 0===i&&(i=!1),new Promise((function(r){var s=0,a=function(){var c=i?e.querySelectorAll(t):e.querySelector(t);i&&c.length||!i&&null!==c?r(c):++s<n?setTimeout(a,o):r(i?document.querySelectorAll(l):null)};a()}))}function c(e,t,n){return new Promise((function(o){var i=0,r=function(){var s=e.shadowRoot;s?o(s):++i<t?setTimeout(r,n):o(null)};r()}))}function u(e){return e instanceof Promise?e:Promise.resolve(e)}function _(e,t,n,l){return o(this,void 0,void 0,(function(){var o,u,_,d,h,f;return i(this,(function(i){switch(i.label){case 0:o=null,u=e.length,_=0,i.label=1;case 1:if(!(_<u))return[3,15];if(0!==_)return[3,8];if(e[_].length)return[3,5];if(t instanceof Document)throw new SyntaxError("You can not select a shadowRoot (".concat(r,") of the document."));return t.shadowRoot?[4,a(t.shadowRoot,e[++_],n,l)]:[3,3];case 2:return d=i.sent(),[3,4];case 3:d=null,i.label=4;case 4:return o=d,[3,7];case 5:return[4,a(t,e[_],n,l)];case 6:o=i.sent(),i.label=7;case 7:return[3,13];case 8:return[4,c(o,n,l)];case 9:return(h=i.sent())?[4,a(h,"".concat(s," ").concat(e[_]),n,l)]:[3,11];case 10:return f=i.sent(),[3,12];case 11:f=null,i.label=12;case 12:o=f,i.label=13;case 13:if(null===o)return[2,null];i.label=14;case 14:return _++,[3,1];case 15:return[2,o]}}))}))}function d(e,t,n,s){return o(this,void 0,void 0,(function(){var o,l,a,c;return i(this,(function(i){switch(i.label){case 0:o=function(e,t){return function(e){return e.split(",").map((function(e){return e.trim()}))}(e).map((function(e){var n=function(e){return e.split(r).map((function(e){return e.trim()}))}(e);return t(n)}))}(e,(function(e){if(!e[e.length-1].length)throw new SyntaxError(function(e,t){var n=t?" If you want to select a shadowRoot, use ".concat(t," instead."):"";return"".concat(e," cannot be used with a selector ending in a shadowRoot (").concat(r,").").concat(n)}("asyncQuerySelector","asyncShadowRootQuerySelector"));return e})),l=o.length,a=0,i.label=1;case 1:return a<l?[4,_(o[a],t,n,s)]:[3,4];case 2:if(c=i.sent())return[2,c];i.label=3;case 3:return a++,[3,1];case 4:return[2,null]}}))}))}var h=function(e,t){var n=e.querySelectorAll(t);if(n.length)return n;if(e instanceof Element&&e.shadowRoot){var o=h(e.shadowRoot,t);if(o.length)return o}for(var i=0,r=Array.from(e.querySelectorAll("*"));i<r.length;i++){var s=r[i],a=h(s,t);if(a.length)return a}return document.querySelectorAll(l)},f=function(e,t,n,o){return new Promise((function(i){var r=0,s=function(){var l=h(e,t);l.length?i(l):++r<n?setTimeout(s,o):i(l)};s()}))};function v(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o(this,void 0,void 0,(function(){var t,n,o,r,s;return i(this,(function(i){switch(i.label){case 0:return function(e){var t,n=e[0],o=e[1];return(t=n)&&(t instanceof Document||t instanceof Element)&&"string"==typeof o}(e)?(t=e[0],n=e[1],o=e[2],[4,d(n,t,(null==o?void 0:o.retries)||10,(null==o?void 0:o.delay)||10)]):[3,2];case 1:case 3:return[2,i.sent()];case 2:return r=e[0],s=e[1],[4,d(r,document,(null==s?void 0:s.retries)||10,(null==s?void 0:s.delay)||10)]}}))}))}var O=function(){function e(e,t){e instanceof Node||e instanceof Promise?(this._element=e,this._asyncParams=n({retries:10,delay:10},t||{})):(this._element=document,this._asyncParams=n({retries:10,delay:10},e||{}))}return Object.defineProperty(e.prototype,"element",{get:function(){return u(this._element).then((function(e){return e instanceof NodeList?e[0]||null:e}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,r,{get:function(){var t=this;return new e(u(this._element).then((function(e){return e instanceof Document||e instanceof ShadowRoot||null===e||e instanceof NodeList&&0===e.length?null:e instanceof NodeList?c(e[0],t._asyncParams.retries,t._asyncParams.delay):c(e,t._asyncParams.retries,t._asyncParams.delay)})),this._asyncParams)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"all",{get:function(){return u(this._element).then((function(e){return e instanceof NodeList?e:document.querySelectorAll(l)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"asyncParams",{get:function(){return this._asyncParams},enumerable:!1,configurable:!0}),e.prototype.eq=function(e){return o(this,void 0,void 0,(function(){return i(this,(function(t){return[2,u(this._element).then((function(t){return t instanceof NodeList&&t[e]||null}))]}))}))},e.prototype.query=function(t){var n=this;return new e(u(this._element).then((function(e){return null===e||e instanceof NodeList&&0===e.length?null:e instanceof NodeList?a(e[0],t,n._asyncParams.retries,n._asyncParams.delay,!0):a(e,t,n._asyncParams.retries,n._asyncParams.delay,!0)})),this._asyncParams)},e.prototype.deepQuery=function(t){var n=this;return new e(u(this._element).then((function(e){return null===e||e instanceof NodeList&&0===e.length?null:e instanceof NodeList?Promise.race(Array.from(e).map((function(e){return f(e,t,n._asyncParams.retries,n._asyncParams.delay)}))):f(e,t,n._asyncParams.retries,n._asyncParams.delay)})),this._asyncParams)},e}(),b=function(e,t){return b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},b(e,t)},y=function(){return y=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},y.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var A,E,p,g,I,m,N,L,R,S,H,D,T,w,G,M,P,F="$",C={retries:100,delay:50};!function(e){e.HOME_ASSISTANT="HOME_ASSISTANT",e.HOME_ASSISTANT_MAIN="HOME_ASSISTANT_MAIN",e.HA_DRAWER="HA_DRAWER",e.HA_SIDEBAR="HA_SIDEBAR"}(A||(A={})),function(e){e.PARTIAL_PANEL_RESOLVER="PARTIAL_PANEL_RESOLVER",e.HA_PANEL_LOVELACE="HA_PANEL_LOVELACE",e.HUI_ROOT="HUI_ROOT",e.HEADER="HEADER",e.HUI_VIEW="HUI_VIEW"}(E||(E={})),function(e){e.HA_MORE_INFO_DIALOG="HA_MORE_INFO_DIALOG",e.HA_DIALOG="HA_DIALOG",e.HA_DIALOG_CONTENT="HA_DIALOG_CONTENT",e.HA_MORE_INFO_DIALOG_INFO="HA_MORE_INFO_DIALOG_INFO",e.HA_DIALOG_MORE_INFO_HISTORY_AND_LOGBOOK="HA_DIALOG_MORE_INFO_HISTORY_AND_LOGBOOK",e.HA_DIALOG_MORE_INFO_SETTINGS="HA_DIALOG_MORE_INFO_SETTINGS"}(p||(p={})),function(e){e.ON_LOVELACE_PANEL_LOAD="onLovelacePanelLoad",e.ON_LOVELACE_MORE_INFO_DIALOG_OPEN="onLovelaceMoreInfoDialogOpen",e.ON_LOVELACE_HISTORY_AND_LOGBOOK_DIALOG_OPEN="onLovelaceHistoryAndLogBookDialogOpen",e.ON_LOVELACE_SETTINGS_DIALOG_OPEN="onLovelaceSettingsDialogOpen"}(g||(g={})),function(e){e.HOME_ASSISTANT="home-assistant",e.HOME_ASSISTANT_MAIN="home-assistant-main",e.HA_DRAWER="ha-drawer",e.HA_SIDEBAR="ha-sidebar",e.PARTIAL_PANEL_RESOLVER="partial-panel-resolver",e.HA_PANEL_LOVELACE="ha-panel-lovelace",e.HUI_ROOT="hui-root",e.HEADER=".header",e.HUI_VIEW="hui-view",e.HA_MORE_INFO_DIALOG="ha-more-info-dialog",e.HA_DIALOG="ha-dialog",e.HA_DIALOG_CONTENT=".content",e.HA_MORE_INFO_DIALOG_INFO="ha-more-info-info",e.HA_DIALOG_MORE_INFO_HISTORY_AND_LOGBOOK="ha-more-info-history-and-logbook",e.HA_DIALOG_MORE_INFO_SETTINGS="ha-more-info-settings"}(P||(P={}));var V,k=((I={})[A.HOME_ASSISTANT]={selector:P.HOME_ASSISTANT,children:{shadowRoot:{selector:F,children:(m={},m[A.HOME_ASSISTANT_MAIN]={selector:P.HOME_ASSISTANT_MAIN,children:{shadowRoot:{selector:F,children:(N={},N[A.HA_DRAWER]={selector:P.HA_DRAWER,children:(L={},L[A.HA_SIDEBAR]={selector:P.HA_SIDEBAR,children:{shadowRoot:{selector:F}}},L)},N)}}},m)}}},I),B=((R={})[E.PARTIAL_PANEL_RESOLVER]={selector:P.PARTIAL_PANEL_RESOLVER,children:(S={},S[E.HA_PANEL_LOVELACE]={selector:P.HA_PANEL_LOVELACE,children:{shadowRoot:{selector:F,children:(H={},H[E.HUI_ROOT]={selector:P.HUI_ROOT,children:{shadowRoot:{selector:F,children:(D={},D[E.HEADER]={selector:P.HEADER},D[E.HUI_VIEW]={selector:P.HUI_VIEW},D)}}},H)}}},S)},R),j={shadowRoot:{selector:F,children:(T={},T[p.HA_MORE_INFO_DIALOG]={selector:P.HA_MORE_INFO_DIALOG,children:{shadowRoot:{selector:F,children:(w={},w[p.HA_DIALOG]={selector:P.HA_DIALOG,children:(G={},G[p.HA_DIALOG_CONTENT]={selector:P.HA_DIALOG_CONTENT,children:(M={},M[p.HA_MORE_INFO_DIALOG_INFO]={selector:P.HA_MORE_INFO_DIALOG_INFO},M[p.HA_DIALOG_MORE_INFO_HISTORY_AND_LOGBOOK]={selector:P.HA_DIALOG_MORE_INFO_HISTORY_AND_LOGBOOK},M[p.HA_DIALOG_MORE_INFO_SETTINGS]={selector:P.HA_DIALOG_MORE_INFO_SETTINGS},M)},G)},w)}}},T)}},x=function(e,t,n,o){return void 0===n&&(n=null),void 0===o&&(o=!1),Object.entries(t||{}).reduce((function(t,i){var r=i[0],s=i[1];if(s.selector===F&&n)return s.children?y(y({},t),x(e,s.children,n,!0)):t;var l=n?n.then((function(t){return v(t,(n=s.selector,o?"$ "+n:n),e);var n})):v(s.selector,e);return t[r]={element:l,children:x(e,s.children,l),selector:new O(l,e)},t}),{})},U=function(e,t){for(var n=0,o=Object.entries(t);n<o.length;n++){var i=o[n];if(i[0]===e)return i[1];var r=U(e,i[1].children);if(r)return r}},q=function(e,t){return Object.keys(e).reduce((function(e,n){var o=U(n,t);o.children;var i=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(n[o[i]]=e[o[i]])}return n}(o,["children"]);return e[n]=y({},i),e}),{})},Y=function(){function e(){this.delegate=document.createDocumentFragment()}return e.prototype.addEventListener=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.delegate).addEventListener.apply(e,t)},e.prototype.dispatchEvent=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this.delegate).dispatchEvent.apply(e,t)},e.prototype.removeEventListener=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this.delegate).removeEventListener.apply(e,t)},e}(),K=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return n._config=y(y({},C),t),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}b(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype._dispatchEvent=function(e,t){this.dispatchEvent(new CustomEvent(e,{detail:t}))},t.prototype._updateDialogElements=function(e){var t,n=this;void 0===e&&(e=p.HA_MORE_INFO_DIALOG_INFO),this._dialogTree=x(this._config,j,this._haRootElements.HOME_ASSISTANT.element);var o=q(p,this._dialogTree);o.HA_DIALOG_CONTENT.element.then((function(e){n._dialogsContentObserver.disconnect(),n._dialogsContentObserver.observe(e,{childList:!0})})),this._haDialogElements=function(e,t){return[p.HA_MORE_INFO_DIALOG,p.HA_DIALOG,p.HA_DIALOG_CONTENT,t].reduce((function(t,n){return t[n]=e[n],t}),{})}(o,e);var i=((t={})[p.HA_MORE_INFO_DIALOG_INFO]=g.ON_LOVELACE_MORE_INFO_DIALOG_OPEN,t[p.HA_DIALOG_MORE_INFO_HISTORY_AND_LOGBOOK]=g.ON_LOVELACE_HISTORY_AND_LOGBOOK_DIALOG_OPEN,t[p.HA_DIALOG_MORE_INFO_SETTINGS]=g.ON_LOVELACE_SETTINGS_DIALOG_OPEN,t);this._dispatchEvent(i[e],this._haDialogElements)},t.prototype._updateRootElements=function(){var e=this;this._homeAssistantRootTree=x(this._config,k),this._haRootElements=q(A,this._homeAssistantRootTree),this._haRootElements[A.HOME_ASSISTANT].selector.$.element.then((function(t){e._dialogsObserver.disconnect(),e._dialogsObserver.observe(t,{childList:!0})}))},t.prototype._updateResolverElements=function(){var e=this,t=Date.now();t-this._timestap<500||(this._timestap=t,this._homeAssistantResolverTree=x(this._config,B,this._haRootElements[A.HA_DRAWER].element),this._haResolverElements=q(E,this._homeAssistantResolverTree),this._haResolverElements[E.PARTIAL_PANEL_RESOLVER].element.then((function(t){e._panelResolverObserver.disconnect(),e._panelResolverObserver.observe(t,{childList:!0})})),this._haResolverElements[E.HA_PANEL_LOVELACE].selector.$.element.then((function(t){e._lovelaceObserver.disconnect(),e._lovelaceObserver.observe(t,{childList:!0})})),this._dispatchEvent(g.ON_LOVELACE_PANEL_LOAD,y(y({},this._haRootElements),this._haResolverElements)))},t.prototype._watchDialogs=function(e){var t=this;e.forEach((function(e){e.addedNodes.forEach((function(e){e.localName===P.HA_MORE_INFO_DIALOG&&t._updateDialogElements()}))}))},t.prototype._watchDialogsContent=function(e){var t=this;e.forEach((function(e){e.addedNodes.forEach((function(e){var n,o=((n={})[P.HA_MORE_INFO_DIALOG_INFO]=p.HA_MORE_INFO_DIALOG_INFO,n[P.HA_DIALOG_MORE_INFO_HISTORY_AND_LOGBOOK]=p.HA_DIALOG_MORE_INFO_HISTORY_AND_LOGBOOK,n[P.HA_DIALOG_MORE_INFO_SETTINGS]=p.HA_DIALOG_MORE_INFO_SETTINGS,n);if(e.localName&&e.localName in o){var i=e.localName;t._updateDialogElements(o[i])}}))}))},t.prototype._watchDashboards=function(e){var t=this;e.forEach((function(e){e.addedNodes.forEach((function(e){e.localName===P.HA_PANEL_LOVELACE&&t._updateResolverElements()}))}))},t.prototype._watchLovelace=function(e){var t=this;e.forEach((function(e){e.addedNodes.forEach((function(e){e.localName===P.HUI_ROOT&&t._updateResolverElements()}))}))},t.prototype.listen=function(){this._watchDialogsBinded=this._watchDialogs.bind(this),this._watchDialogsContentBinded=this._watchDialogsContent.bind(this),this._watchDashboardsBinded=this._watchDashboards.bind(this),this._watchLovelaceBinded=this._watchLovelace.bind(this),this._dialogsObserver=new MutationObserver(this._watchDialogsBinded),this._dialogsContentObserver=new MutationObserver(this._watchDialogsContentBinded),this._panelResolverObserver=new MutationObserver(this._watchDashboardsBinded),this._lovelaceObserver=new MutationObserver(this._watchLovelaceBinded),this._updateRootElements(),this._updateResolverElements()},t.prototype.addEventListener=function(t,n,o){e.prototype.addEventListener.call(this,t,n,o)},t}(Y),W="custom_more_info";!function(e){e.HUI_VIEW="hui-view",e.MORE_INFO_CONTENT="more-info-content",e.MORE_INFO_HSTORY="ha-more-info-history",e.MORE_INFO_LOGBOOK="ha-more-info-logbook",e.HA_ATTRIBUTES="ha-attributes"}(V||(V={}));var $=/[.?+^$[\]\\(){}|-]/g,Q=["assumed_state","attribution","custom_ui_more_info","custom_ui_state_card","device_class","editable","emulated_hue_name","emulated_hue","entity_id","entity_picture","event_types","friendly_name","haaska_hidden","haaska_name","icon","initial_state","last_reset","restored","state_class","supported_features","unit_of_measurement"],z=function(e){return e.localName},J=function(e){var t=z(e);return e.querySelector("#".concat(W,"_").concat(t))},X=function(e){return"".concat(e," {\n        display: none !important;\n    }")};console.info("%c  ".concat("Custom-more-info","  \n%c  Version ").concat("1.0.0"," ").concat("Custom more-info for Home Assistant"),"color: gold; font-weight: bold; background: black","color: white; font-weight: bold; background: steelblue");var Z=function(){function n(){var e=this;this._selector=new K,this._selector.addEventListener(g.ON_LOVELACE_PANEL_LOAD,(function(t){e._debug("lovelace panel has been rendered so loading the configuration"),e.storeConfig(t.detail)})),this._selector.addEventListener(g.ON_LOVELACE_MORE_INFO_DIALOG_OPEN,(function(t){e._debug("a more info dialog has been opened so applying customizations"),e.applyCustomizations(t.detail)})),this._selector.listen()}return n.prototype._insertAttributesGlobs=function(e,t,n,o,i){this._addSetValues(o,this._getFiltersByGlob(e,t)),this._addSetValues(i,this._getFiltersByGlob(e,n))},n.prototype._insertParameters=function(e,t,n,o){this._addSetValues(n,e),this._addSetValues(o,t)},n.prototype._getEntityIdRegExp=function(e){var t=e.replace($,"\\$&").replace(/\*/g,".*");return new RegExp("^".concat(t,"$"))},n.prototype._addSetValues=function(e,t){void 0===t&&(t=[]),t.forEach((function(t){e.add(t)}))},n.prototype._debug=function(e){var t;(null===(t=this._config)||void 0===t?void 0:t.debug)&&("object"!=typeof e||e instanceof Node?console.debug(e):console.debug(JSON.stringify(e,null,4)))},n.prototype._globMatch=function(e,t){return this._getEntityIdRegExp(t).test(e)},n.prototype._anyGlobMatch=function(e,t){var n=this;return void 0===t&&(t=[]),!!t.find((function(t){return n._globMatch(e,t)}))},n.prototype._getFiltersByGlob=function(e,t){var n=this;void 0===t&&(t={});var o=[];return Object.entries(t).forEach((function(t){var i=t[0],r=t[1];n._globMatch(e,i)&&o.push.apply(o,r)})),o},n.prototype.storeConfig=function(e){var t=this;e.HA_PANEL_LOVELACE.element.then((function(e){var n,o,i=null===(o=null===(n=null==e?void 0:e.lovelace)||void 0===n?void 0:n.config)||void 0===o?void 0:o.custom_more_info;i?(t._config=i,t._debug("the config has been loaded, printing the config...")):t._config&&Object.keys(t._config).length?t._debug("this dashboard doesnâ€˜t contain a config but there is a previous one in memory..."):(t._debug("no config has been found so initiating an empty config..."),t._config={}),t._filters={},t._visibility={},t._debug(t._config)}))},n.prototype.applyCustomizations=function(n){return e(this,void 0,void 0,(function(){var e,o,i,r,s,l,a=this;return t(this,(function(t){switch(t.label){case 0:return e=n.HA_MORE_INFO_DIALOG,o=n.HA_MORE_INFO_DIALOG_INFO,n.HA_DIALOG_CONTENT,[4,e.element];case 1:return i=t.sent(),[4,(c=function(){var e;return null===(e=i.___entry)||void 0===e?void 0:e.entity_id},u=function(e){return!!e},new Promise((function(e){var t=0,n=function(){var o=c();o&&u(o)?e(o):++t<500?setTimeout(n,50):e(o)};n()})))];case 2:return r=t.sent(),s=r.replace(/^(.+)\..+$/,"$1"),l=i.___entry.original_device_class,o.selector.$.query(V.MORE_INFO_CONTENT).deepQuery(V.HA_ATTRIBUTES).element.then((function(e){a._debug("finished the task of querying attributes, the result is"),e?(a._debug("attributes have been found"),a._debug(e),a.applyAttributesFilters(e,r,s,l)):a._debug("attributes have not been found")})),o.selector.$.deepQuery([V.MORE_INFO_HSTORY,V.MORE_INFO_LOGBOOK].join(",")).element.then((function(e){a._debug("finished the task of querying the history or logbook of the dialog, the result is"),e?(a._debug("history or logbook have been found"),a._debug(e),a.applyVisibility(e.parentElement,r,s,l)):a._debug("dialog content has not been found")})),[2]}var c,u}))}))},n.prototype.applyAttributesFilters=function(e,t,n,o){var i=this.getFilters(e.__stateObj.attributes,t,n,o),r=i.filter_attributes.filter((function(e){return!i.unfilter_attributes.includes(e)})),s=e.extraFilters||"",l=s.length?",":"";e.extraFilters=s+l+r.join(","),i.unfilter_attributes.length&&i.unfilter_attributes.forEach((function(t){Q.includes(t)&&t in e.__stateObj.attributes&&(e.__stateObj.attributes["".concat(t," ")]=e.__stateObj.attributes[t])}))},n.prototype.applyVisibility=function(e,t,n,o){var i,r,s,l,a=this.getVisibility(t,n,o),c=[a.hide_history?X(V.MORE_INFO_HSTORY):"",a.hide_logbook?X(V.MORE_INFO_LOGBOOK):""];a.hide_history||a.hide_logbook?(i=e,r=c.join(""),s=z(i),(l=J(i))||((l=document.createElement("style")).setAttribute("id","".concat(W,"_").concat(s)),i.appendChild(l)),l.innerHTML=r):function(e){var t=z(e);J(e)&&e.querySelector("#".concat(W,"_").concat(t)).remove()}(e)},n.prototype.getFilters=function(e,t,n,o){var i,r,s,l,a,c,u,_,d,h,f,v,O,b,y,A,E,p,g,I,m,N,L,R;if(this._debug("getting the filters for ".concat(t)),this._filters[t])return this._debug("the filters for this entity have been found in memory, recovering filters..."),this._debug(this._filters[t]),this._filters[t];var S=new Set,H=new Set;return this._insertAttributesGlobs(t,null===(r=null===(i=this._config)||void 0===i?void 0:i.filter_attributes)||void 0===r?void 0:r.by_glob,null===(l=null===(s=this._config)||void 0===s?void 0:s.unfilter_attributes)||void 0===l?void 0:l.by_glob,S,H),this._insertParameters(null===(u=null===(c=null===(a=this._config)||void 0===a?void 0:a.filter_attributes)||void 0===c?void 0:c.by_device_class)||void 0===u?void 0:u[o],null===(h=null===(d=null===(_=this._config)||void 0===_?void 0:_.unfilter_attributes)||void 0===d?void 0:d.by_device_class)||void 0===h?void 0:h[o],S,H),this._insertParameters(null===(O=null===(v=null===(f=this._config)||void 0===f?void 0:f.filter_attributes)||void 0===v?void 0:v.by_domain)||void 0===O?void 0:O[n],null===(A=null===(y=null===(b=this._config)||void 0===b?void 0:b.unfilter_attributes)||void 0===y?void 0:y.by_domain)||void 0===A?void 0:A[n],S,H),this._insertParameters(null===(g=null===(p=null===(E=this._config)||void 0===E?void 0:E.filter_attributes)||void 0===p?void 0:p.by_entity_id)||void 0===g?void 0:g[t],null===(N=null===(m=null===(I=this._config)||void 0===I?void 0:I.unfilter_attributes)||void 0===m?void 0:m.by_entity_id)||void 0===N?void 0:N[t],S,H),((null===(L=this._config)||void 0===L?void 0:L.filter_all)||S.has("all"))&&this._addSetValues(S,Object.keys(e)),((null===(R=this._config)||void 0===R?void 0:R.unfilter_all)||H.has("all"))&&this._addSetValues(H,Object.keys(e)),this._filters[t]={filter_attributes:Array.from(S.values()),unfilter_attributes:Array.from(H.values())},this._debug("finished the filters retrieval, printing the filters..."),this._debug(this._filters[t]),this._filters[t]},n.prototype.getVisibility=function(e,t,n){var o,i,r,s,l,a,c,u,_,d,h,f,v,O,b,y,A,E,p,g,I,m,N,L,R,S,H,D,T,w,G,M,P,F,C,V,k,B,j,x,U,q,Y,K;if(this._debug("getting the visibility for ".concat(e)),this._visibility[e])return this._debug("the visibility for this entity have been found in memory, recovering visibility..."),this._debug(this._visibility[e]),this._visibility[e];var W={history:!1,logbook:!1};return(this._anyGlobMatch(e,null===(i=null===(o=this._config)||void 0===o?void 0:o.hide_history)||void 0===i?void 0:i.by_glob)||(null===(l=null===(s=null===(r=this._config)||void 0===r?void 0:r.hide_history)||void 0===s?void 0:s.by_device_class)||void 0===l?void 0:l.includes(n))||(null===(u=null===(c=null===(a=this._config)||void 0===a?void 0:a.hide_history)||void 0===c?void 0:c.by_domain)||void 0===u?void 0:u.includes(t))||(null===(h=null===(d=null===(_=this._config)||void 0===_?void 0:_.hide_history)||void 0===d?void 0:d.by_entity_id)||void 0===h?void 0:h.includes(e)))&&(W.history=!0),(this._anyGlobMatch(e,null===(v=null===(f=this._config)||void 0===f?void 0:f.unhide_history)||void 0===v?void 0:v.by_glob)||(null===(y=null===(b=null===(O=this._config)||void 0===O?void 0:O.unhide_history)||void 0===b?void 0:b.by_device_class)||void 0===y?void 0:y.includes(n))||(null===(p=null===(E=null===(A=this._config)||void 0===A?void 0:A.unhide_history)||void 0===E?void 0:E.by_domain)||void 0===p?void 0:p.includes(t))||(null===(m=null===(I=null===(g=this._config)||void 0===g?void 0:g.unhide_history)||void 0===I?void 0:I.by_entity_id)||void 0===m?void 0:m.includes(e)))&&(W.history=!1),(this._anyGlobMatch(e,null===(L=null===(N=this._config)||void 0===N?void 0:N.hide_logbook)||void 0===L?void 0:L.by_glob)||(null===(H=null===(S=null===(R=this._config)||void 0===R?void 0:R.hide_logbook)||void 0===S?void 0:S.by_device_class)||void 0===H?void 0:H.includes(n))||(null===(w=null===(T=null===(D=this._config)||void 0===D?void 0:D.hide_logbook)||void 0===T?void 0:T.by_domain)||void 0===w?void 0:w.includes(t))||(null===(P=null===(M=null===(G=this._config)||void 0===G?void 0:G.hide_logbook)||void 0===M?void 0:M.by_entity_id)||void 0===P?void 0:P.includes(e)))&&(W.logbook=!0),(this._anyGlobMatch(e,null===(C=null===(F=this._config)||void 0===F?void 0:F.unhide_logbook)||void 0===C?void 0:C.by_glob)||(null===(B=null===(k=null===(V=this._config)||void 0===V?void 0:V.unhide_logbook)||void 0===k?void 0:k.by_device_class)||void 0===B?void 0:B.includes(n))||(null===(U=null===(x=null===(j=this._config)||void 0===j?void 0:j.unhide_logbook)||void 0===x?void 0:x.by_domain)||void 0===U?void 0:U.includes(t))||(null===(K=null===(Y=null===(q=this._config)||void 0===q?void 0:q.unhide_logbook)||void 0===Y?void 0:Y.by_entity_id)||void 0===K?void 0:K.includes(e)))&&(W.logbook=!1),this._visibility[e]={hide_history:W.history,hide_logbook:W.logbook},this._debug("finished the visibility retrieval, printing the visibility..."),this._debug(this._visibility[e]),this._visibility[e]},n}();Promise.resolve(customElements.whenDefined(V.HUI_VIEW)).then((function(){window.customMoreInfo=new Z}))}();
