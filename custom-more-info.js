!function(){"use strict";function t(t,e,n,o){return new(n||(n=Promise))((function(i,r){function l(t){try{a(o.next(t))}catch(t){r(t)}}function s(t){try{a(o.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(l,s)}a((o=o.apply(t,e||[])).next())}))}function e(t,e){var n,o,i,r,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(l=0)),l;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return l.label++,{value:s[1],done:!1};case 5:l.label++,o=s[1],s=[0];continue;case 7:s=l.ops.pop(),l.trys.pop();continue;default:if(!(i=l.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){l=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){l.label=s[1];break}if(6===s[0]&&l.label<i[1]){l.label=i[1],i=s;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(s);break}i[2]&&l.ops.pop(),l.trys.pop();continue}s=e.call(t,l)}catch(t){s=[6,t],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}"function"==typeof SuppressedError&&SuppressedError;var n=function(){return n=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},n.apply(this,arguments)};function o(t,e,n,o){return new(n||(n=Promise))((function(i,r){function l(t){try{a(o.next(t))}catch(t){r(t)}}function s(t){try{a(o.throw(t))}catch(t){r(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(l,s)}a((o=o.apply(t,e||[])).next())}))}function i(t,e){var n,o,i,r,l={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(l=0)),l;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return l.label++,{value:s[1],done:!1};case 5:l.label++,o=s[1],s=[0];continue;case 7:s=l.ops.pop(),l.trys.pop();continue;default:if(!((i=(i=l.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){l=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){l.label=s[1];break}if(6===s[0]&&l.label<i[1]){l.label=i[1],i=s;break}if(i&&l.label<i[2]){l.label=i[2],l.ops.push(s);break}i[2]&&l.ops.pop(),l.trys.pop();continue}s=e.call(t,l)}catch(t){s=[6,t],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}"function"==typeof SuppressedError&&SuppressedError;var r="$",l=":host",s="invalid selector",a=10,u=10,c=function(t){var e,n=t[0],o=t[1];return(e=n)&&(e instanceof Document||e instanceof Element||e instanceof ShadowRoot)&&"string"==typeof o};function _(t,e){return function(t){return t.split(",").map((function(t){return t.trim()}))}(t).map((function(t){var n=function(t){return t.split(r).map((function(t){return t.trim()}))}(t);return e(n)}))}var d=function(t,e,n,o){return new Promise((function(i){var r=0,l=function(){var s=t();e(s)?i(s):++r<n?setTimeout(l,o):i(s)};l()}))};function h(t,e){var n=e?" If you want to select a shadowRoot, use ".concat(e," instead."):"";return"".concat(t," cannot be used with a selector ending in a shadowRoot (").concat(r,").").concat(n)}function f(t){return t instanceof Promise?t:Promise.resolve(t)}function v(){return"You can not select a shadowRoot (".concat(r,") of the document.")}function O(){return"You can not select a shadowRoot (".concat(r,") of a shadowRoot.")}function y(t,e){for(var n,o,i=null,r=t.length,s=0;s<r;s++){if(0===s)if(t[s].length)i=e.querySelector(t[s]);else{if(e instanceof Document)throw new SyntaxError(v());if(e instanceof ShadowRoot)throw new SyntaxError(O());i=(null===(n=e.shadowRoot)||void 0===n?void 0:n.querySelector(t[++s]))||null}else i=(null===(o=i.shadowRoot)||void 0===o?void 0:o.querySelector("".concat(l," ").concat(t[s])))||null;if(null===i)return null}return i}function E(t,e){var n,o=function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))}([],t,!0),i=o.pop();if(!o.length)return e.querySelectorAll(i);var r=y(o,e);return(null===(n=null==r?void 0:r.shadowRoot)||void 0===n?void 0:n.querySelectorAll("".concat(l," ").concat(i)))||null}function b(t,e){if(1===t.length&&!t[0].length){if(e instanceof Document)throw new SyntaxError(v());if(e instanceof ShadowRoot)throw new SyntaxError(O());return e.shadowRoot}var n=y(t,e);return(null==n?void 0:n.shadowRoot)||null}function A(t,e,n,r){return o(this,void 0,void 0,(function(){return i(this,(function(o){return[2,d((function(){return function(t,e,n,o){void 0===n&&(n="querySelector"),void 0===o&&(o="shadowRootQuerySelector");for(var i=_(t,(function(t){if(!t[t.length-1].length)throw new SyntaxError(h(n,o));return t})),r=i.length,l=0;l<r;l++){var s=y(i[l],e);if(s)return s}return null}(t,e,"asyncQuerySelector","asyncShadowRootQuerySelector")}),(function(t){return!!t}),n,r)]}))}))}function g(t,e,n,r){return o(this,void 0,void 0,(function(){return i(this,(function(o){return[2,d((function(){return function(t,e,n){void 0===n&&(n="querySelectorAll");for(var o=_(t,(function(t){if(!t[t.length-1].length)throw new SyntaxError(h(n));return t})),i=o.length,r=0;r<i;r++){var l=E(o[r],e);if(null==l?void 0:l.length)return l}return document.querySelectorAll(s)}(t,e,"asyncQuerySelectorAll")}),(function(t){return!!t.length}),n,r)]}))}))}function p(t,e,n,l){return o(this,void 0,void 0,(function(){return i(this,(function(o){return[2,d((function(){return function(t,e,n,o){void 0===n&&(n="shadowRootQuerySelector"),void 0===o&&(o="querySelector");for(var i=_(t,(function(t){if(t.pop().length)throw new SyntaxError(function(t,e){return"".concat(t," must be used with a selector ending in a shadowRoot (").concat(r,"). If you don't want to select a shadowRoot, use ").concat(e," instead.")}(n,o));return t})),l=i.length,s=0;s<l;s++){var a=b(i[s],e);if(a)return a}return null}(t,e,"asyncShadowRootQuerySelector","asyncQuerySelector")}),(function(t){return!!t}),n,l)]}))}))}var I=function(t,e){var n=t.querySelectorAll(e);if(n.length)return n;if(t instanceof Element&&t.shadowRoot){var o=I(t.shadowRoot,e);if(o.length)return o}for(var i=0,r=Array.from(t.querySelectorAll("*"));i<r.length;i++){var l=r[i],a=I(l,e);if(a.length)return a}return document.querySelectorAll(s)},N=function(t,e,n,o){return d((function(){return I(t,e)}),(function(t){return!!t.length}),n,o)};function m(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o(this,void 0,void 0,(function(){var e,n,o,r,l;return i(this,(function(i){switch(i.label){case 0:return c(t)?(e=t[0],n=t[1],o=t[2],[4,A(n,e,(null==o?void 0:o.retries)||a,(null==o?void 0:o.delay)||u)]):[3,2];case 1:case 3:return[2,i.sent()];case 2:return r=t[0],l=t[1],[4,A(r,document,(null==l?void 0:l.retries)||a,(null==l?void 0:l.delay)||u)]}}))}))}function S(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o(this,void 0,void 0,(function(){var e,n,o,r,l;return i(this,(function(i){switch(i.label){case 0:return c(t)?(e=t[0],n=t[1],o=t[2],[4,g(n,e,(null==o?void 0:o.retries)||a,(null==o?void 0:o.delay)||u)]):[3,2];case 1:return[2,i.sent()];case 2:return r=t[0],l=t[1],[2,g(r,document,(null==l?void 0:l.retries)||a,(null==l?void 0:l.delay)||u)]}}))}))}function R(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o(this,void 0,void 0,(function(){var e,n,o,r,l;return i(this,(function(i){switch(i.label){case 0:return c(t)?(e=t[0],n=t[1],o=t[2],[4,p(n,e,(null==o?void 0:o.retries)||a,(null==o?void 0:o.delay)||u)]):[3,2];case 1:return[2,i.sent()];case 2:return r=t[0],l=t[1],[2,p(r,document,(null==l?void 0:l.retries)||a,(null==l?void 0:l.delay)||u)]}}))}))}var L=function(){function t(t,e){t instanceof Node||t instanceof Promise?(this._element=t,this._asyncParams=n({retries:a,delay:u},e||{})):(this._element=document,this._asyncParams=n({retries:a,delay:u},t||{}))}return Object.defineProperty(t.prototype,"element",{get:function(){return f(this._element).then((function(t){return t instanceof NodeList?t[0]||null:t}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,r,{get:function(){var e=this;return new t(f(this._element).then((function(t){return t instanceof Document||t instanceof ShadowRoot||null===t||t instanceof NodeList&&0===t.length?null:t instanceof NodeList?R(t[0],r,e._asyncParams):R(t,r,e._asyncParams)})),this._asyncParams)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"all",{get:function(){return f(this._element).then((function(t){return t instanceof NodeList?t:document.querySelectorAll(s)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"asyncParams",{get:function(){return this._asyncParams},enumerable:!1,configurable:!0}),t.prototype.eq=function(t){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,f(this._element).then((function(e){return e instanceof NodeList&&e[t]||null}))]}))}))},t.prototype.query=function(e){var n=this;return new t(f(this._element).then((function(t){return null===t||t instanceof NodeList&&0===t.length?null:t instanceof NodeList?S(t[0],e,n._asyncParams):S(t,e,n._asyncParams)})),this._asyncParams)},t.prototype.deepQuery=function(e){var n=this;return new t(f(this._element).then((function(t){return null===t||t instanceof NodeList&&0===t.length?null:t instanceof NodeList?Promise.race(Array.from(t).map((function(t){return N(t,e,n._asyncParams.retries,n._asyncParams.delay)}))):N(t,e,n._asyncParams.retries,n._asyncParams.delay)})),this._asyncParams)},t}(),D=function(t,e){return D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},D(t,e)},H=function(){return H=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},H.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var T,w,G,M,P,F,k,C,j,B,V,q,x,U,Y,K,$="$",W={retries:100,delay:50};!function(t){t.HOME_ASSISTANT="HOME_ASSISTANT",t.HOME_ASSISTANT_MAIN="HOME_ASSISTANT_MAIN",t.HA_DRAWER="HA_DRAWER",t.HA_SIDEBAR="HA_SIDEBAR",t.PARTIAL_PANEL_RESOLVER="PARTIAL_PANEL_RESOLVER"}(T||(T={})),function(t){t.HA_PANEL_LOVELACE="HA_PANEL_LOVELACE",t.HUI_ROOT="HUI_ROOT",t.HEADER="HEADER",t.HUI_VIEW="HUI_VIEW"}(w||(w={})),function(t){t.HA_MORE_INFO_DIALOG="HA_MORE_INFO_DIALOG",t.HA_DIALOG="HA_DIALOG",t.HA_DIALOG_CONTENT="HA_DIALOG_CONTENT",t.HA_MORE_INFO_DIALOG_INFO="HA_MORE_INFO_DIALOG_INFO",t.HA_DIALOG_MORE_INFO_HISTORY_AND_LOGBOOK="HA_DIALOG_MORE_INFO_HISTORY_AND_LOGBOOK",t.HA_DIALOG_MORE_INFO_SETTINGS="HA_DIALOG_MORE_INFO_SETTINGS"}(G||(G={})),function(t){t.ON_LISTEN="onListen",t.ON_PANEL_LOAD="onPanelLoad",t.ON_LOVELACE_PANEL_LOAD="onLovelacePanelLoad",t.ON_MORE_INFO_DIALOG_OPEN="onMoreInfoDialogOpen",t.ON_HISTORY_AND_LOGBOOK_DIALOG_OPEN="onHistoryAndLogBookDialogOpen",t.ON_SETTINGS_DIALOG_OPEN="onSettingsDialogOpen"}(M||(M={})),function(t){t.HOME_ASSISTANT="home-assistant",t.HOME_ASSISTANT_MAIN="home-assistant-main",t.HA_DRAWER="ha-drawer",t.HA_SIDEBAR="ha-sidebar",t.PARTIAL_PANEL_RESOLVER="partial-panel-resolver",t.HA_PANEL_LOVELACE="ha-panel-lovelace",t.HUI_ROOT="hui-root",t.HEADER=".header",t.HUI_VIEW="hui-view",t.HA_MORE_INFO_DIALOG="ha-more-info-dialog",t.HA_DIALOG="ha-dialog",t.HA_DIALOG_CONTENT=".content",t.HA_MORE_INFO_DIALOG_INFO="ha-more-info-info",t.HA_DIALOG_MORE_INFO_HISTORY_AND_LOGBOOK="ha-more-info-history-and-logbook",t.HA_DIALOG_MORE_INFO_SETTINGS="ha-more-info-settings"}(K||(K={}));var Q,z,J,X=((P={})[T.HOME_ASSISTANT]={selector:K.HOME_ASSISTANT,children:{shadowRoot:{selector:$,children:(F={},F[T.HOME_ASSISTANT_MAIN]={selector:K.HOME_ASSISTANT_MAIN,children:{shadowRoot:{selector:$,children:(k={},k[T.HA_DRAWER]={selector:K.HA_DRAWER,children:(C={},C[T.HA_SIDEBAR]={selector:K.HA_SIDEBAR,children:{shadowRoot:{selector:$}}},C[T.PARTIAL_PANEL_RESOLVER]={selector:K.PARTIAL_PANEL_RESOLVER},C)},k)}}},F)}}},P),Z=((j={})[w.HA_PANEL_LOVELACE]={selector:K.HA_PANEL_LOVELACE,children:{shadowRoot:{selector:$,children:(B={},B[w.HUI_ROOT]={selector:K.HUI_ROOT,children:{shadowRoot:{selector:$,children:(V={},V[w.HEADER]={selector:K.HEADER},V[w.HUI_VIEW]={selector:K.HUI_VIEW},V)}}},B)}}},j),tt={shadowRoot:{selector:$,children:(q={},q[G.HA_MORE_INFO_DIALOG]={selector:K.HA_MORE_INFO_DIALOG,children:{shadowRoot:{selector:$,children:(x={},x[G.HA_DIALOG]={selector:K.HA_DIALOG,children:(U={},U[G.HA_DIALOG_CONTENT]={selector:K.HA_DIALOG_CONTENT,children:(Y={},Y[G.HA_MORE_INFO_DIALOG_INFO]={selector:K.HA_MORE_INFO_DIALOG_INFO},Y[G.HA_DIALOG_MORE_INFO_HISTORY_AND_LOGBOOK]={selector:K.HA_DIALOG_MORE_INFO_HISTORY_AND_LOGBOOK},Y[G.HA_DIALOG_MORE_INFO_SETTINGS]={selector:K.HA_DIALOG_MORE_INFO_SETTINGS},Y)},U)},x)}}},q)}},et=function(t,e,n,o){return void 0===n&&(n=null),void 0===o&&(o=!1),Object.entries(e||{}).reduce((function(e,i){var r=i[0],l=i[1];if(l.selector===$&&n)return l.children?H(H({},e),et(t,l.children,n,!0)):e;var s=n?n.then((function(e){return m(e,(n=l.selector,o?"$ "+n:n),t);var n})):m(l.selector,t);return e[r]={element:s,children:et(t,l.children,s),selector:new L(s,t)},e}),{})},nt=function(t,e){for(var n=0,o=Object.entries(e);n<o.length;n++){var i=o[n];if(i[0]===t)return i[1];var r=nt(t,i[1].children);if(r)return r}},ot=function(t,e){return Object.keys(t).reduce((function(t,n){var o=nt(n,e);o.children;var i=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(t);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(t,o[i])&&(n[o[i]]=t[o[i]])}return n}(o,["children"]);return t[n]=H({},i),t}),{})},it=function(){function t(){this.delegate=document.createDocumentFragment()}return t.prototype.addEventListener=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];(t=this.delegate).addEventListener.apply(t,e)},t.prototype.dispatchEvent=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return(t=this.delegate).dispatchEvent.apply(t,e)},t.prototype.removeEventListener=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return(t=this.delegate).removeEventListener.apply(t,e)},t}(),rt=function(t){function e(e){void 0===e&&(e={});var n=t.call(this)||this;return n._config=H(H({},W),e),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}D(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype._dispatchEvent=function(t,e){this.dispatchEvent(new CustomEvent(t,{detail:e}))},e.prototype._updateDialogElements=function(t){var e,n=this;void 0===t&&(t=G.HA_MORE_INFO_DIALOG_INFO),this._dialogTree=et(this._config,tt,this._haRootElements.HOME_ASSISTANT.element);var o=ot(G,this._dialogTree);o.HA_DIALOG_CONTENT.element.then((function(t){n._dialogsContentObserver.disconnect(),n._dialogsContentObserver.observe(t,{childList:!0})})),this._haDialogElements=function(t,e){return[G.HA_MORE_INFO_DIALOG,G.HA_DIALOG,G.HA_DIALOG_CONTENT,e].reduce((function(e,n){return e[n]=t[n],e}),{})}(o,t);var i=((e={})[G.HA_MORE_INFO_DIALOG_INFO]=M.ON_MORE_INFO_DIALOG_OPEN,e[G.HA_DIALOG_MORE_INFO_HISTORY_AND_LOGBOOK]=M.ON_HISTORY_AND_LOGBOOK_DIALOG_OPEN,e[G.HA_DIALOG_MORE_INFO_SETTINGS]=M.ON_SETTINGS_DIALOG_OPEN,e);this._dispatchEvent(i[t],this._haDialogElements)},e.prototype._updateRootElements=function(){var t=this;this._homeAssistantRootTree=et(this._config,X),this._haRootElements=ot(T,this._homeAssistantRootTree),this._haRootElements[T.HOME_ASSISTANT].selector.$.element.then((function(e){t._dialogsObserver.disconnect(),t._dialogsObserver.observe(e,{childList:!0})})),this._haRootElements[T.PARTIAL_PANEL_RESOLVER].element.then((function(e){t._panelResolverObserver.disconnect(),e&&t._panelResolverObserver.observe(e,{childList:!0})})),this._dispatchEvent(M.ON_LISTEN,this._haRootElements),this._dispatchEvent(M.ON_PANEL_LOAD,this._haRootElements)},e.prototype._updateLovelaceElements=function(){var t=this,e=Date.now();e-this._timestap<500||(this._timestap=e,this._homeAssistantResolverTree=et(this._config,Z,this._haRootElements[T.HA_DRAWER].element),this._haResolverElements=ot(w,this._homeAssistantResolverTree),this._haResolverElements[w.HA_PANEL_LOVELACE].selector.$.element.then((function(e){t._lovelaceObserver.disconnect(),e&&(t._lovelaceObserver.observe(e,{childList:!0}),t._dispatchEvent(M.ON_LOVELACE_PANEL_LOAD,H(H({},t._haRootElements),t._haResolverElements)))})))},e.prototype._watchDialogs=function(t){var e=this;t.forEach((function(t){t.addedNodes.forEach((function(t){t.localName===K.HA_MORE_INFO_DIALOG&&e._updateDialogElements()}))}))},e.prototype._watchDialogsContent=function(t){var e=this;t.forEach((function(t){t.addedNodes.forEach((function(t){var n,o=((n={})[K.HA_MORE_INFO_DIALOG_INFO]=G.HA_MORE_INFO_DIALOG_INFO,n[K.HA_DIALOG_MORE_INFO_HISTORY_AND_LOGBOOK]=G.HA_DIALOG_MORE_INFO_HISTORY_AND_LOGBOOK,n[K.HA_DIALOG_MORE_INFO_SETTINGS]=G.HA_DIALOG_MORE_INFO_SETTINGS,n);if(t.localName&&t.localName in o){var i=t.localName;e._updateDialogElements(o[i])}}))}))},e.prototype._watchDashboards=function(t){var e=this;t.forEach((function(t){t.addedNodes.forEach((function(t){e._dispatchEvent(M.ON_PANEL_LOAD,e._haRootElements),t.localName===K.HA_PANEL_LOVELACE&&e._updateLovelaceElements()}))}))},e.prototype._watchLovelace=function(t){var e=this;t.forEach((function(t){t.addedNodes.forEach((function(t){t.localName===K.HUI_ROOT&&e._updateLovelaceElements()}))}))},e.prototype.listen=function(){this._watchDialogsBinded=this._watchDialogs.bind(this),this._watchDialogsContentBinded=this._watchDialogsContent.bind(this),this._watchDashboardsBinded=this._watchDashboards.bind(this),this._watchLovelaceBinded=this._watchLovelace.bind(this),this._dialogsObserver=new MutationObserver(this._watchDialogsBinded),this._dialogsContentObserver=new MutationObserver(this._watchDialogsContentBinded),this._panelResolverObserver=new MutationObserver(this._watchDashboardsBinded),this._lovelaceObserver=new MutationObserver(this._watchLovelaceBinded),this._updateRootElements(),this._updateLovelaceElements()},e.prototype.addEventListener=function(e,n,o){t.prototype.addEventListener.call(this,e,n,o)},e}(it),lt="custom_more_info";!function(t){t.HUI_VIEW="hui-view",t.MORE_INFO_CONTENT="more-info-content",t.MORE_INFO_HISTORY="ha-more-info-history",t.MORE_INFO_LOGBOOK="ha-more-info-logbook",t.HA_ATTRIBUTES="ha-attributes",t.MENU_ITEM="ha-icon-button",t.MENU_ITEM_ICON="mwc-icon-button",t.MORE_INFO_HEADER="ha-dialog-header",t.MORE_INFO_HEADER_HISTORY='ha-icon-button[data-custom-selector="DIALOG_HISTORY"]'}(z||(z={})),function(t){t.SEARCH="SEARCH",t.ASSIST="ASSIST",t.REFRESH="REFRESH",t.UNUSED_ENTITIES="UNUSED_ENTITIES",t.RELOAD_RESOURCES="RELOAD_RESOURCES",t.EDIT_DASHBOARD="EDIT_DASHBOARD",t.DIALOG_DISMISS="DIALOG_DISMISS",t.DIALOG_HISTORY="DIALOG_HISTORY",t.DIALOG_SETTINGS="DIALOG_SETTINGS"}(J||(J={}));var st="".concat("ui",".dialogs.more_info_control"),at=Object.freeze(((Q={})[J.DIALOG_HISTORY]="".concat(st,".history"),Q[J.DIALOG_SETTINGS]="".concat(st,".settings"),Q[J.DIALOG_DISMISS]="".concat(st,".dismiss"),Q)),ut=/[.?+^$[\]\\(){}|-]/g,ct=["assumed_state","attribution","custom_ui_more_info","custom_ui_state_card","device_class","editable","emulated_hue_name","emulated_hue","entity_id","entity_picture","event_types","friendly_name","haaska_hidden","haaska_name","icon","initial_state","last_reset","restored","state_class","supported_features","unit_of_measurement"],_t=function(t){return t instanceof ShadowRoot?t.host.localName:t.localName},dt=function(t){var e=_t(t);return t.querySelector("#".concat(lt,"_").concat(e))},ht=function(t,e){var n=_t(t),o=dt(t);o||((o=document.createElement("style")).setAttribute("id","".concat(lt,"_").concat(n)),t.appendChild(o)),o.innerHTML=e},ft=function(t){var e=_t(t);dt(t)&&t.querySelector("#".concat(lt,"_").concat(e)).remove()},vt=function(t){return"".concat(t," {\n        display: none !important;\n    }")},Ot=function(t){var e=0,n=Object.values(at);return new Promise((function(o,i){var r=function(){var l,s=null===(l=null==t?void 0:t.hass)||void 0===l?void 0:l.resources,a=!1;if(s){var u=t.hass.language;n.find((function(t){return!s[u][t]}))||(a=!0)}a?o(s):++e<500?setTimeout(r,50):i()};r()}))},yt=function(){function n(){var t=this;this._selector=new rt({retries:5,delay:500}),this._selector.addEventListener(M.ON_LOVELACE_PANEL_LOAD,(function(e){t.storeConfig(e.detail)})),this._selector.addEventListener(M.ON_MORE_INFO_DIALOG_OPEN,(function(e){t._debug("a more info dialog has been opened so applying customizations"),t.queryAttributes(e.detail),t.queryHistoryAndLogbook(e.detail)})),this._selector.addEventListener(M.ON_HISTORY_AND_LOGBOOK_DIALOG_OPEN,(function(e){t._debug("a history and logbook dialog has been opened so applying customizations"),t.queryHistoryAndLogbook(e.detail)})),this._selector.listen()}return n.prototype._insertAttributesGlobs=function(t,e,n,o,i){this._addSetValues(o,this._getFiltersByGlob(t,e)),this._addSetValues(i,this._getFiltersByGlob(t,n))},n.prototype._insertParameters=function(t,e,n,o){this._addSetValues(n,t),this._addSetValues(o,e)},n.prototype._getEntityIdRegExp=function(t){var e=t.replace(ut,"\\$&").replace(/\*/g,".*");return new RegExp("^".concat(e,"$"))},n.prototype._addSetValues=function(t,e){void 0===e&&(e=[]),e.forEach((function(e){t.add(e)}))},n.prototype._debug=function(t){var e;(null===(e=this._config)||void 0===e?void 0:e.debug)&&("object"!=typeof t||t instanceof Node?console.debug(t):console.debug(JSON.stringify(t,null,4)))},n.prototype._globMatch=function(t,e){return this._getEntityIdRegExp(e).test(t)},n.prototype._anyGlobMatch=function(t,e){var n=this;return void 0===e&&(e=[]),!!e.find((function(e){return n._globMatch(t,e)}))},n.prototype._getFiltersByGlob=function(t,e){var n=this;void 0===e&&(e={});var o=[];return Object.entries(e).forEach((function(e){var i=e[0],r=e[1];n._globMatch(t,i)&&o.push.apply(o,r)})),o},n.prototype.storeConfig=function(n){var o=this;n.HA_PANEL_LOVELACE.element.then((function(t){var e,n,i=null===(n=null===(e=null==t?void 0:t.lovelace)||void 0===e?void 0:e.config)||void 0===n?void 0:n.custom_more_info;i?(o._config=i,o._debug("the config has been loaded, printing the config...")):o._config&&Object.keys(o._config).length?o._debug("this dashboard doesn‘t contain a config but there is a previous one in memory..."):(o._debug("no config has been found so initiating an empty config..."),o._config={}),o._filters={},o._visibility={},o._debug(o._config)})).finally((function(){n.HOME_ASSISTANT.element.then((function(n){(function(n){return t(void 0,void 0,void 0,(function(){var t,o,i,r,l;return e(this,(function(e){switch(e.label){case 0:return[4,Ot(n)];case 1:return t=e.sent(),o=n.hass.language,i=t[o],r=Object.entries(at),l=r.map((function(t){var e=t[0],n=t[1];return[i[n],e]})),[2,Object.fromEntries(l)]}}))}))})(n).then((function(t){o._translations=t,o._debug("translations have been retrieved. printing the translations"),o._debug(o._translations)})).catch((function(){o._debug("error getting the translations")}))}))}))},n.prototype.queryAttributes=function(n){return t(this,void 0,void 0,(function(){var t=this;return e(this,(function(e){return n.HA_MORE_INFO_DIALOG_INFO.selector.$.query(z.MORE_INFO_CONTENT).deepQuery(z.HA_ATTRIBUTES).element.then((function(e){t._debug("finished the task of querying attributes, the result is"),e?(t._debug("attributes have been found"),t._debug(e),t.filterAttributes(e)):t._debug("this dialog doesn‘t have attributes or the attributes have not been found")})),[2]}))}))},n.prototype.queryHistoryAndLogbook=function(n){return t(this,void 0,void 0,(function(){var t,o,i,r,l,s,a,u,c=this;return e(this,(function(e){switch(e.label){case 0:return t=n.HA_DIALOG,o=n.HA_MORE_INFO_DIALOG,i=n.HA_DIALOG_CONTENT,[4,o.element];case 1:return r=e.sent(),[4,(_=function(){var t;return null===(t=r.___entry)||void 0===t?void 0:t.entity_id},d=function(t){return!!t},new Promise((function(t){var e=0,n=function(){var o=_();o&&d(o)?t(o):++e<500?setTimeout(n,50):t(o)};n()})))];case 2:return l=e.sent(),s=l.replace(/^(.+)\..+$/,"$1"),a=r.___entry.original_device_class,u=this.getVisibility(l,s,a),t.selector.query(z.MORE_INFO_HEADER).element.then((function(t){t?(c._debug("finished the task of querying the header, the result is"),c._debug(t),c._addDataSelectors(t),c._hideHeaderElements(t,u)):c._debug("this dialog doesn‘t have a header or it has not been found")})),i.selector.deepQuery([z.MORE_INFO_HISTORY,z.MORE_INFO_LOGBOOK].join(",")).element.then((function(t){if(c._debug("finished the task of querying the history or logbook of the dialog, the result is"),t){var e=t.parentElement||t.getRootNode();c._debug("history or logbook have been found"),c._debug(t),c.hideContentElements(e,u)}else c._debug("this dialog doesn‘t have history or logbook or they have not been found.")})),[2]}var _,d}))}))},n.prototype.filterAttributes=function(t){var e=this.getFilters(t),n=e.filter_attributes.filter((function(t){return!e.unfilter_attributes.includes(t)})),o=t.extraFilters||"",i=o.length?",":"";t.extraFilters=o+i+n.join(","),e.unfilter_attributes.length&&e.unfilter_attributes.forEach((function(e){ct.includes(e)&&e in t.__stateObj.attributes&&(t.__stateObj.attributes["".concat(e," ")]=t.__stateObj.attributes[e])}))},n.prototype.hideContentElements=function(t,e){var n=[e.hide_history?vt(z.MORE_INFO_HISTORY):"",e.hide_logbook?vt(z.MORE_INFO_LOGBOOK):""];e.hide_history||e.hide_logbook?ht(t,n.join("")):ft(t)},n.prototype._addDataSelectors=function(t){var e,n;e=t.querySelectorAll(z.MENU_ITEM),n=this._translations,e.forEach((function(t){if(t&&t.dataset&&!t.dataset.customSelector){var e=t.shadowRoot.querySelector(z.MENU_ITEM_ICON);t.dataset.customSelector=n[e.title]}}))},n.prototype._hideHeaderElements=function(t,e){this._translations?e.hide_header_history?ht(t,vt(z.MORE_INFO_HEADER_HISTORY)):ft(t):this._debug("skiping the header history task, because translations don‘t exist")},n.prototype.getFilters=function(t){var e,n,o,i,r,l,s,a,u,c,_,d,h,f,v,O,y,E,b,A,g,p,I,N,m=t.__stateObj.entity_id,S=t.__stateObj.attributes.device_class,R=m.replace(/^(.+)\..+$/,"$1");if(this._debug("getting the filters for ".concat(m)),this._filters[m])return this._debug("the filters for this entity have been found in memory, recovering filters..."),this._debug(this._filters[m]),this._filters[m];var L=new Set,D=new Set;return this._insertAttributesGlobs(m,null===(n=null===(e=this._config)||void 0===e?void 0:e.filter_attributes)||void 0===n?void 0:n.by_glob,null===(i=null===(o=this._config)||void 0===o?void 0:o.unfilter_attributes)||void 0===i?void 0:i.by_glob,L,D),this._insertParameters(null===(s=null===(l=null===(r=this._config)||void 0===r?void 0:r.filter_attributes)||void 0===l?void 0:l.by_device_class)||void 0===s?void 0:s[S],null===(c=null===(u=null===(a=this._config)||void 0===a?void 0:a.unfilter_attributes)||void 0===u?void 0:u.by_device_class)||void 0===c?void 0:c[S],L,D),this._insertParameters(null===(h=null===(d=null===(_=this._config)||void 0===_?void 0:_.filter_attributes)||void 0===d?void 0:d.by_domain)||void 0===h?void 0:h[R],null===(O=null===(v=null===(f=this._config)||void 0===f?void 0:f.unfilter_attributes)||void 0===v?void 0:v.by_domain)||void 0===O?void 0:O[R],L,D),this._insertParameters(null===(b=null===(E=null===(y=this._config)||void 0===y?void 0:y.filter_attributes)||void 0===E?void 0:E.by_entity_id)||void 0===b?void 0:b[m],null===(p=null===(g=null===(A=this._config)||void 0===A?void 0:A.unfilter_attributes)||void 0===g?void 0:g.by_entity_id)||void 0===p?void 0:p[m],L,D),((null===(I=this._config)||void 0===I?void 0:I.filter_all)||L.has("all"))&&this._addSetValues(L,Object.keys(t.__stateObj.attributes)),((null===(N=this._config)||void 0===N?void 0:N.unfilter_all)||D.has("all"))&&this._addSetValues(D,Object.keys(t.__stateObj.attributes)),this._filters[m]={filter_attributes:Array.from(L.values()),unfilter_attributes:Array.from(D.values())},this._debug("finished the filters retrieval, printing the filters..."),this._debug(this._filters[m]),this._filters[m]},n.prototype.getVisibility=function(t,e,n){var o,i,r,l,s,a,u,c,_,d,h,f,v,O,y,E,b,A,g,p,I,N,m,S,R,L,D,H,T,w,G,M,P,F,k,C,j,B,V,q,x,U,Y,K,$,W,Q,z,J,X,Z,tt,et,nt,ot,it,rt,lt,st,at,ut,ct,_t,dt,ht,ft,vt;if(this._debug("getting the visibility for ".concat(t)),this._visibility[t])return this._debug("the visibility for this entity have been found in memory, recovering visibility..."),this._debug(this._visibility[t]),this._visibility[t];var Ot={history:!1,logbook:!1,header_history:!1};return(this._anyGlobMatch(t,null===(i=null===(o=this._config)||void 0===o?void 0:o.hide_history)||void 0===i?void 0:i.by_glob)||(null===(s=null===(l=null===(r=this._config)||void 0===r?void 0:r.hide_history)||void 0===l?void 0:l.by_device_class)||void 0===s?void 0:s.includes(n))||(null===(c=null===(u=null===(a=this._config)||void 0===a?void 0:a.hide_history)||void 0===u?void 0:u.by_domain)||void 0===c?void 0:c.includes(e))||(null===(h=null===(d=null===(_=this._config)||void 0===_?void 0:_.hide_history)||void 0===d?void 0:d.by_entity_id)||void 0===h?void 0:h.includes(t)))&&(Ot.history=!0),(this._anyGlobMatch(t,null===(v=null===(f=this._config)||void 0===f?void 0:f.unhide_history)||void 0===v?void 0:v.by_glob)||(null===(E=null===(y=null===(O=this._config)||void 0===O?void 0:O.unhide_history)||void 0===y?void 0:y.by_device_class)||void 0===E?void 0:E.includes(n))||(null===(g=null===(A=null===(b=this._config)||void 0===b?void 0:b.unhide_history)||void 0===A?void 0:A.by_domain)||void 0===g?void 0:g.includes(e))||(null===(N=null===(I=null===(p=this._config)||void 0===p?void 0:p.unhide_history)||void 0===I?void 0:I.by_entity_id)||void 0===N?void 0:N.includes(t)))&&(Ot.history=!1),(this._anyGlobMatch(t,null===(S=null===(m=this._config)||void 0===m?void 0:m.hide_logbook)||void 0===S?void 0:S.by_glob)||(null===(D=null===(L=null===(R=this._config)||void 0===R?void 0:R.hide_logbook)||void 0===L?void 0:L.by_device_class)||void 0===D?void 0:D.includes(n))||(null===(w=null===(T=null===(H=this._config)||void 0===H?void 0:H.hide_logbook)||void 0===T?void 0:T.by_domain)||void 0===w?void 0:w.includes(e))||(null===(P=null===(M=null===(G=this._config)||void 0===G?void 0:G.hide_logbook)||void 0===M?void 0:M.by_entity_id)||void 0===P?void 0:P.includes(t)))&&(Ot.logbook=!0),(this._anyGlobMatch(t,null===(k=null===(F=this._config)||void 0===F?void 0:F.unhide_logbook)||void 0===k?void 0:k.by_glob)||(null===(B=null===(j=null===(C=this._config)||void 0===C?void 0:C.unhide_logbook)||void 0===j?void 0:j.by_device_class)||void 0===B?void 0:B.includes(n))||(null===(x=null===(q=null===(V=this._config)||void 0===V?void 0:V.unhide_logbook)||void 0===q?void 0:q.by_domain)||void 0===x?void 0:x.includes(e))||(null===(K=null===(Y=null===(U=this._config)||void 0===U?void 0:U.unhide_logbook)||void 0===Y?void 0:Y.by_entity_id)||void 0===K?void 0:K.includes(t)))&&(Ot.logbook=!1),(this._anyGlobMatch(t,null===(W=null===($=this._config)||void 0===$?void 0:$.hide_header_history)||void 0===W?void 0:W.by_glob)||(null===(J=null===(z=null===(Q=this._config)||void 0===Q?void 0:Q.hide_header_history)||void 0===z?void 0:z.by_device_class)||void 0===J?void 0:J.includes(n))||(null===(tt=null===(Z=null===(X=this._config)||void 0===X?void 0:X.hide_header_history)||void 0===Z?void 0:Z.by_domain)||void 0===tt?void 0:tt.includes(e))||(null===(ot=null===(nt=null===(et=this._config)||void 0===et?void 0:et.hide_header_history)||void 0===nt?void 0:nt.by_entity_id)||void 0===ot?void 0:ot.includes(t)))&&(Ot.header_history=!0),(this._anyGlobMatch(t,null===(rt=null===(it=this._config)||void 0===it?void 0:it.unhide_header_history)||void 0===rt?void 0:rt.by_glob)||(null===(at=null===(st=null===(lt=this._config)||void 0===lt?void 0:lt.unhide_header_history)||void 0===st?void 0:st.by_device_class)||void 0===at?void 0:at.includes(n))||(null===(_t=null===(ct=null===(ut=this._config)||void 0===ut?void 0:ut.unhide_header_history)||void 0===ct?void 0:ct.by_domain)||void 0===_t?void 0:_t.includes(e))||(null===(ft=null===(ht=null===(dt=this._config)||void 0===dt?void 0:dt.unhide_header_history)||void 0===ht?void 0:ht.by_entity_id)||void 0===ft?void 0:ft.includes(t)))&&(Ot.header_history=!1),this._visibility[t]={hide_history:Ot.history,hide_logbook:Ot.logbook,hide_header_history:Ot.header_history||!!(null===(vt=this._config)||void 0===vt?void 0:vt.auto_hide_header_history)&&Ot.history&&Ot.logbook},this._debug("finished the visibility retrieval, printing the visibility..."),this._debug(this._visibility[t]),this._visibility[t]},n}();window.customMoreInfo||(console.info("%c  ".concat("Custom-more-info","  \n%c  Version ").concat("1.0.0"," ").concat("Custom more-info for Home Assistant"),"color: gold; font-weight: bold; background: black","color: white; font-weight: bold; background: steelblue"),window.customMoreInfo=new yt)}();
